// JavaScript code inserted here...
// [omitted for brevity, already provided above]
// The full code will be included again if needed.